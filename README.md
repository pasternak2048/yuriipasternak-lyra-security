# 🛡️ LYRA.Security — *Your Signature Toolkit*

**LYRA.Security** provides the cryptographic, signature, and contract foundation for the **LYRA** ecosystem — enabling secure, policy-based communication between trusted systems.

It offers reusable types, helpers, and strategies for building secure communication across services and companies.

> 🔐 Designed to empower both clients and servers. Built for reuse. Built for trust.

---

## 🌐 What is LYRA.Security?

- 🔑 **Contracts** — security-focused request/response contracts between client and server
- 🔐 **Crypto Helpers** — HMAC / SHA hashing, secret generation, payload validation
- 🔁 **Signature Builders** — customizable `StringToSign` logic for HTTP, events, cache, etc.
- 🧩 **Enums** — consistent representation of `AccessContext`, `SignatureType`, etc.

> 💡 LYRA.Security is the core that powers `LYRA.Client`, `LYRA.Server`, and your own secure integrations.

---

## 📦 What’s inside?

| Module                 | Description |
|------------------------|-------------|
| `VerifyRequest`        | A signed request with payload, signature, and system metadata |
| `VerifyResponse`       | Response indicating success or failure, with status and audit info |
| `AccessContext`        | Enum describing the nature of interaction (Http, Event, Cache, etc.) |
| `SignatureType`        | Signature algorithm: `HMAC`, `RSA`, `None` |
| `EncryptionHelper`     | Static helper for computing HMAC, SHA-512, secrets |
| `ISignatureStringBuilder` | Interface for generating a canonical `StringToSign` |
| `HttpSignatureStringBuilder` | Default implementation for HTTP context |
| `SignatureStringBuilderFactory` | Factory to resolve appropriate builder by context |

---

## 🧠 Core Concepts

| Concept             | Description |
|--------------------|-------------|
| `PayloadHash`       | SHA-512 hash of the raw payload body (before signing) |
| `StringToSign`      | Canonical string used to produce the final signature |
| `Signature`         | Base64 HMAC or RSA signature generated by the sender |
| `SystemName`        | Unique identifier for the calling or receiving system |
| `VerifyRequest`     | The signed contract sent to `LYRA.Server` or any verifier |

---

## 🔁 Signing Flow (Client-side)

1. Hash the payload body (e.g. JSON) using SHA-512
2. Build a `StringToSign` (method + path + hash)
3. Compute HMAC-SHA512 using a secret key
4. Create a `VerifyRequest` and send to verifier

---

## ✅ Example: Creating a VerifyRequest

```csharp
var hash = EncryptionHelper.ComputeSha512(payload);
var toSign = builder.BuildStringToSign("POST", "/api/orders", hash);
var signature = EncryptionHelper.ComputeHmacSha512(toSign, secret);

var request = new VerifyRequest
{
    CallerSystemName = "gateway@acorp",
    Context = AccessContext.Http,
    Operation = "POST /api/orders",
    Payload = payload,
    Signature = signature
};
```

---

## 🚀 Ideal Use Cases

- 🔐 Clients signing requests before sending to other services
- 🧪 Testing LYRA.Server without tight coupling
- 🧰 Building your own lightweight authorization logic
- 📦 Creating middleware or SDKs for verified requests

---

## 🧱 Used By

- **LYRA.Server** — for verifying incoming requests
- **LYRA.Client** — for signing outgoing ones
- **GLORIA.*** microservices — as part of internal request security

---

## 🔧 Tech Stack

- C# 12 / .NET Standard 2.1 / .NET 8 compatible
- `System.Security.Cryptography` for hashing and signing
- Zero third-party dependencies
- Can be used as a NuGet package or direct project reference

---

## 📄 License

Licensed under the [MIT License](LICENSE).

**LYRA.Security. The signature is the firewall.**
> “The truth is in the signature.”
